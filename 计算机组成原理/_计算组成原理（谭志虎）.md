# 计算机组成原理

## chap1计算机系统概述

### 1.2.1 计算机硬件系统

#### 系统互连

计算机硬件系统各功能部件还需要有组织地以某种方式连接起来，从而实现数据流信息和 控制流信息在不同部件之间的流动及数据信息的加工处理。在现代计算机中使用较多的就是**总线互连方案**，这种方式实现简单，扩展容易。

 **总线（Bus）是连接两个或多个设备（部件）的公共信息通路。它主要由数据线、地址线和控制线组成**。CPU连接计算机中各主要部件的总线称为系统总线。基于单总线结构的系统互连，如图1.5所示。图1.5 中的所有设备均与总线相连。由于总线是多个设备的公共连接线，因此同一时刻只能允许一个设备向总线发送信息，但可以允许多个设备同时接收来自总线的信息。关于总线的详细内容将在第8章讲述。

![image-20250218183758248](D:\universityResource\_课程\计算机组成原理_大一下\pic\总线互联方案0218.png)

## chap2

### 海明码

## chap3 运算方法和运算器

#### C语言中的类型转换

*   位扩展
    *   整数：无符号数高位补0，有符号数高位补原符号位
    *   定点小数：末尾补0

#### 位移

*   循环位移：将被移除的数据补到空出的位置。

#### 补码的加减法

*   和的补码 = 补码的和
*   差的补码 = 补码的差 ， 要求$[-Y]_补$。
*   求补：
    *   无论Y是正数还是负数，每一位都取反，再在最低为位加1
    *   扫描：从右往左找到第一个1，左边的数字全部取反
*   对于不同位数的符号位运算，要先进行符号位拓展，对齐时再运算。

#### 溢出检测

*   无符号数：$UOF = Sub \oplus C_{out}$
    *   Sub表示是否做减法，这里严格来说不能通过符号位等来判断，只能依靠输入。
    *   sub=0表示正数相加，若$C_{out}=1$则表示有溢出
    *   sub=1表示正数相减（正负数相加），此时$C_{out}=0$表示溢出。对于无符号数相减，会先取补变成有符号数运算（但仍然会用无符号数解释），我们理想成原来的数的最高位都是0，那么变成0+1，若不进位，则表示仍有符号位1，表示出来的是有符号的负数，用无符号数解释的时候会出错，即溢出。（若最高位不是0，则是极端情况，依然符合）

*   有符号数：最高位进位状态$\oplus$次高位进位状态=1，则溢出
*   双符号位：双符号位最高位永远是正确的符号位，因此不同则为溢出。因为成本问题未使用。
    *   $00.X+00.X->01.X$是正上溢出
    *   $11.X+11.X->10.X$是负上溢出

#### 串行加法器

![image-20250409133806245](D:\universityResource\_课程\计算机组成原理_大一下\pic\串行加法器.png)

*   单符号位对$C_{n-1}$和$C_{n}$做一次异或就可以判断溢出
*   双符号位对最高位和次高位做一次异或就可以判断
*   可以发现，两者在判断成本上一样，都需要一个门电路。、

#### 先行进位加法器

 $n$ 位串行加法电路中高位的运算依赖低位进位输入$C_i$ ，所以所有全加器不能并行运行，其时 间关键延迟为$(2n+4)T$，与位数呈线性关系，当位宽较大时性能较差。如果能打破这种链式关系，运行速度就会有很大提升。

先行进位加法器的总延时为$2T$。

![image-20250410195849973](D:\universityResource\_课程\计算机组成原理_大一下\pic\可级联的4位先行进位电路.png)

常见的4位快速先行进位集成电路有SN74182芯片，有兴趣的读者可以查阅相关芯片手册。

#### 并行加法器

也称，快速加法器。

![image-20250410203106697](D:\universityResource\_课程\计算机组成原理_大一下\pic\四位先行快速加法器.png)

#### 16位加法器

![image-20250410203219019](D:\universityResource\_课程\计算机组成原理_大一下\pic\16位加法器.png)











#### 补码乘法

Booth提出了Booth算法，可以直接计算补码乘法。经过严格的数学推导加算法改进，可以得到**补码一位乘法**的算法。在$x \times y$中，我们规定 $ y $ 是乘数。

1.   乘数采用单符号位，末位增设附加位$y_{n+1}$，初值为0 。
2.   利用$y_{n+1}-y_{n}$判断：
     *   差值为1：累加上$[x]_补$。
     *   差值为0：+0 。
     *   差值为-1：累加上$-[x]_{补}$。
     *   这一段的硬件实现可以直接比较$y_{n}y_{n+1}$是$01 , 10 , 00 or 11$ 。
3.   每次累加以后都要进行一次算数右移操作。最后一步不移动，也就是说第一次累加开始时要移动，直到最后一次累加不移动。而且是算数右移。
4.   符号位单独运算，不需要单独计算符号位。

####  硬件实现

1.   借助加法器实现，**原理利用原码补码一位乘法**，成本低
2.   设置专用乘法器实现，**阵列乘法器**，**补码阵列乘法器**，成本高
3.   使用乘法运算子程序实现，零硬件成本

![image-20250410210244957](D:\universityResource\_课程\计算机组成原理_大一下\pic\原码阵列乘法器.png)

依然是串行进位，所以可以改进成如下：



#### 3.4 定点除法运算

## chap4 存储系统

### 4.1 存储器概述

#### 4.1.1 存储器分类

1.   按存储介质分类

     1.   磁存储器

          磁存储器都以磁性材料作为存储介质，利用磁化单元剩磁的不同磁化方向来存储数据0和1。它主要包括**磁芯、磁盘、磁带存储器**等，目前广泛使用的磁盘、磁带中**都包含机械装置**，所以其**体积大、存取速度慢，但磁存储器单位容量成本最低**。

     2.   半导体存储器 

          **用半导体器件组成的存储器称为半导体存储器。**

          目前有两大类：

          ​	**一种是双极型存储器，主要包括TTL型和ECL型两种**；

          ​	另一种是**金属氧化物半导体存储器**，简称MOS存储器，又可分为静态MOS存储器（SRAM）和动态MOS存储器（DRAM）。

          **半导体存储器体积小，存储速 度快，但单位容量成本相对较高。**

     3.   光存储器

          光存储器**利用介质的光学特性读出数据**，如**CD-ROM、DVD-ROM**均以刻痕的形式将数据存储在盘面上，用激光束照射盘面，靠盘面的不同反射率来读出信息。

          而**磁光盘则利用激光加热辅助磁化的方式写入数据**，根据反射光的偏振方向的不同来读出信息。

          **光盘存储器便于携带，成本低廉，适用于电子出版物的发行。**

2.   按存取方式分类

     1.   随机存储器

          随机存储器（Random Access Memory，RAM）可以按照地址随机读写数据存储单元，且存取访问时间与存储单元的位置无关。

          **早期的磁芯存储器和当前大量使用的半导体存储器都是随机存储器。**

     2.   顺序存储器

          顺序存储器（Sequential Access Memory，SAM）是指存储单元中的内容**只能依地址顺序访问**，**且访问的速度与存储单元的位置有关的存储器**，典型的如**磁带存储器**。

     3.   直接存储器

          直接存储器（Direct Access Memory，DAM）是指不必经过顺序搜索就能在存储器中直接存取信息的存储器，这类存储器**兼有随机存储器和顺序存储器的访问特性**，典型的如**磁盘存储器**。 

          **磁盘由于存在机械寻道和旋转延迟，因此数据访问时间和磁头与目标扇区的距离有关系。**

3.   按信息的可改写性分类

     既能读出又能写入信息的存储器称为**读写存储器**。

     而有些存储器中的内容不允许被改变，只能读出其中的内容，这种存储器称为**只读存储器**（Read Only Memory，ROM），常见的有半导体只读存储器，也有光盘存储器，如CD-ROM、DVD-ROM等。

4.   按信息的可保存性分类

     按照信息保存的时间和条件的不同，存储器分为**易失性存储器和非易失性存储器**。

     易失性存储器是指断电后，所保存的信息会丢失的存储器，常见的如**半导体RAM**。

     非易失性存储器是指断电后，所保存的信息不丢失的存储器，常见的有**半导体ROM、闪存、磁盘、光盘存储器等**。

5.   按功能和存取速度分类

     1.   寄存器存储器
     2.   高速缓冲存储器，又称高速缓存cache，一般采用SRAM构成
     3.   主存储器，主存储器简称主存，是CPU中除寄存器外唯一能直接访问的存储器，用于存放指令和数据。一般由半导体存储器构成，但注意**主存并不是单一的内存，还包括BIOS、硬件端口等**。
     4.   外存储器，简称外存或辅助存储器。目前广泛使用的外存储器包括磁盘、磁带、光盘存储器、磁盘阵列和网络存储 系统等。

---

硬盘驱动器（HDD, Hard Disk Drive）

**原理**：利用磁性存储技术，数据存储在高速旋转的磁盘上，通过磁头读写。

**特点**：
    容量大（可达数十TB）、成本低（单位容量价格低）。
    速度较慢（因机械结构限制，读写速度约100-200 MB/s）。
    易受震动或跌落损坏。
**用途**：大容量数据存储（如服务器、备份系统）。

---

固态硬盘（SSD, Solid State Drive）

**原理**：基于闪存（NAND Flash）技术，无机械部件，通过电子信号读写。
**特点**：
    速度快（读写速度可达数千MB/s，延迟极低）。
    抗震、低功耗、无噪音。
    寿命有限（受闪存擦写次数限制），单位容量成本高于HDD。
**用途**：操作系统安装、高性能应用（如游戏、视频编辑）。

---

混合硬盘（SSHD）
**原理**：结合HDD的大容量和SSD的高速缓存（小容量闪存加速常用数据）。
**特点**：性价比介于HDD和SSD之间，适合需要兼顾容量与性能的场景。

---

#### 4.1.2 存储器技术指标

##### 存储容量

存储器可以存储的二进制信息总量称为存储容量。

1.   位表示法。

     以存储器中的存储单元总数与存储字位数的乘积表示，如：

     **1K×4位表示该芯片有1K个单元（1K＝1024），每个存储单元的长度为4个二进制位。**

2.   字节表示法。

     以存储器中的单元总数表示，一个存储单元由8个二进制位组成，称为 一个字节，用B表示），如：

     **128B表示该芯片有128个单元，每个单元都是一个字节，每个字节都由8个二进制位组成**。

##### 存取速度 

1.   **存取时间**：又称为存储器的访问时间，是指启动一次存储器操作（读或写分别对应取与存）到该操作完成所经历的时间，

     注意**读写时间可能不同，DRAM读慢写快、闪存读快写慢。** 

2.   存取周期：连续启动两次访问操作之间的最短时间间隔；对主存而言，存储周期除包 括存取时间外，还包括存储器状态的稳定恢复时间，所以存储周期略大于存取时间。 

3.   存储器带宽：单位时间内存储器所能传输的信息量，常用的单位包括**位/秒**或**字节/ 秒**；带宽是衡量数据传输速率的重要指标，与存取时间的长短和一次传输的数据位的多少有关； 一般而言存取时间越短、数据位宽越大，存储带宽越高。

#### 4.1.3 存储系统层次结构

![image-20250519112312099](D:\universityResource\_课程\计算机组成原理_大一下\pic\存储系统的分级结构.png)

#### 4.1.4 主存的基本结构

可以看作一个一维数组。指针所指向的其实就是这个一维数组的`index`。

![image-20250519142148178](D:\universityResource\_课程\计算机组成原理_大一下\pic\主存的内部硬件.png)

*   地址译码器接收来自CPU的n位地址信号，经译码、驱动后形成$2^n$根地址译码信号，每一根地址译码信号连接一个存储单元。每给出一个地址，$2^n$个地址译码信号中只有与地址值对应的那个信号才有效，与之连接的存储单元被选中，输出m位数据。 

*   数据寄存器暂存CPU送来的m位数据，或暂存从存储体中读出的m位数据。

*   读写控制电路接收CPU的读写控制信号后产生存储器内部的控制信号，将指定地址的信息从存储体中读出并送到数据寄存器中供CPU使用，或将来自CPU并已存入数据寄存器的信息写入存储体中的指定单元。

#### 4.1.5 主存中数据的存放

1.   存储字长与数据字长的概念

     *   **存储字长**：主存的一个存储单元所存储的二进制位数。
     *   **数据字长（简称 字长）**：计算机一次能处理的二进制数的位数。 
     *   **存储字长与数据字长不一定相同，如字长为32位的计算机所采用的存储字长可以是16位、32位或64位。**

2.   地址访问模式

     **存储字长都是字节的整倍数，主存通常按字节进行编址。**

     以32位计算机为例，主存既可以按字节访问，也可以按16位半字访问，还可以按照32位的字进行访问。按照访问存储单元的大小， 主存地址可以分为字节地址、半字地址、字地址。

     **在32位计算机中：字节地址逻辑右移一位即可得到半字地址，右移两位可得到字地址。**

     ![image-20250519143441815](D:\universityResource\_课程\计算机组成原理_大一下\pic\不同主存地址的访问模式.png)

     **不同的地址访问给出的主存地址实际都是字节地址。**

     >   [!TIP]
     >
     >   在汇编指令中，本质上还是给出标准的字节地址，然后通过访问方式，如字节地址访问、半字访问、字访问，选择对应的数据大小。（此时还会结合大端小端法决定顺序）。
     >
     >   注意：
     >
     >   这里的访问方式只能决定大小，比如，不考虑对齐等其他要求的话：
     >
     >   -   **字访问时**：低2位（bit1和bit0）用于选择字中的具体字节。例如：
     >       -   `00`：选择字的第1个字节。
     >       -   `01`：选择字的第2个字节。
     >       -   `10`：选择字的第3个字节。
     >       -   `11`：选择字的第4个字节。
     >   -   **半字访问时**：最低1位（bit0）用于选择半字中的具体字节：
     >       -   `0`：选择半字的第1个字节。
     >       -   `1`：选择半字的第2个字节。
     >   -   **倒数第2位（bit1）**：在半字访问时，如果访问的是字中的半字，bit1用于选择字中的哪个半字：
     >       -   `0`：选择字的低半字（前2字节）。
     >       -   `1`：选择字的高半字（后2字节）。
     >
     >   类似于一个二叉树的寻址方式。
     >
     >   这样设计是为了灵活支持不同大小的数据访问（字节、半字、字），同时确保地址对齐和正确访问内存中的数据。

3.   大端和小端方式

     *   **小端Little-Endian**：当存储器的低字节地址单元中存放的是数据的最低字节

     *   **大端Big-Endian**：当存储器的低字节地址单元中存放的是数据的最高字节

         主流处理器一般都采用小端方式进行数据存放，如Intel x86、IA64处理器、RISC-V处理器。

          有的处理器系统采用了大端方式进行数据存放，如PowerPC处理器。

         还有的处理器同时支持大端和小端方式，如ARM、MIPS处理器。

         除处理器外，外部设备设计、TCIP/IP数据传输、音频和视频文件中都存在数据存放方式的选择问题。

4.   数据的边界对齐

     **目前主流编译器不仅会对数据变量进行边界对齐，还会对复杂的数据结构进行边界对齐。**

### 4.2 半导体存储器

半导体存储器的主要特点是存取速度快、体积小、性能可靠，已成为实现主存的首选器件。 半导体存储器通常分为随机存储器和只读存储器。



**存储单元**是存储器中的最小存储单位，也称为存储元，其作用是存储一位二进制信息。

**存储单元的基本功能**：

*   具有两种稳定状态。 
*   两种稳定状态经外部信号控制可以相互转换。 
*   经控制后能读出其中的信息。 
*   无外部原因，其中的信息能长期保存。（在系统运行和供电时能长期保存）

#### 4.2.1 静态MOS存储器SRAM

以静态MOS存储元为基本单元组成的存储器称为静态MOS存储器（SRAM）。

##### 静态MOS存储单元

静态存储单元的结构有多种，一种典型的**6管SRAM存储单元电路**如图4.6所示。

其中 T1 、T2 为工作管；T3 、T4 为负载管（功耗管）；T5 、T6 、T7 、T8 为门控管，相当于控制开关，控制存储单元数据信息与外界的连通或隔离。**静态存储单元由T1 、T2 组成的双稳态触发器存储一位二进制信息。**

![image-20250519150315595](D:\universityResource\_课程\计算机组成原理_大一下\6管SRAM存储单元.png)

关于存储单元的详细介绍见书101页。一般会封装成下图的样子：

![image-20250519150908617](D:\universityResource\_课程\计算机组成原理_大一下\pic\6管SRAM封装.png)

##### 存储单元扩展

可以从一个存储单元拓展成存储矩阵，可以随机访问其中任何一位数据。

加上行缓冲器，就可以一次访问一整行的内容，但无法访问一整列的内容。

下面是扩展的4K大小的存储矩阵：

![image-20250519151510549](D:\universityResource\_课程\计算机组成原理_大一下\pic\4K存储矩阵.png)

一次读出一行：

![image-20250519151706592](C:\Users\szl-d\AppData\Roaming\Typora\typora-user-images\4K存储矩阵_行通选.png)



**译码器Decoder**，我更喜欢称之为解码器，是组合逻辑电路，其功能是将n位二进制信号输入翻译成 $2^n$ 个输出信号，每个输出信号都是n位输入的最小项，所以**译码器也称为最小项发生器**。比如，我输入 6 位二进制数 `001001`（即 $A_5A_4A_3A_2A_1A_0=001001$），其对应的十进制是`9`，那么输出序列$Y_9 = 1 ; Y_{else}=0  其中，{else} \in (0 \to 8)\cup (10 \to 63)$ 。



假设地址位宽为 n 位，对于一维行扩展，只需要一个 n 路输入译码器即可，这种结构也称为**单译码结构**。

其译码输出信号为$2^n$根，假设$n＝16$，则$2^n$＝65536。

**随着n值变大，译码器电路的开销不容忽视，另外译码输出过多也会占用较多的晶圆面积，其生产制造也会存在困难**

而对于二维行列扩展，需在行列两个方向各设置一个n/2＝8路输入译码器（行、列地址数目也可以不一样），这种结构称为**双译码结构**。其译码输出信号为$2×2^{\frac{n}{2}}＝512%$根，存储容量为$2^{\frac{n}{2}} \times 2^{\frac{n}{2}} ＝ 2^n$，和单译码结构一样，但输出信号少很多，译码电路成本也会大大降低.

因此**在大容量存储器中普遍采用双译码结构**。单译码和双译码结构具体原理如图4.9所示。

![image-20250519154229260](D:\universityResource\_课程\计算机组成原理_大一下\pic\单译码和双译码结构.png)

通过二维存储扩展，很容易构建大容量的SRAM，但这样的存储器给出地址后，同一时刻只有一个存储单元被选中，一次只能访问一位数据，而实际存储器均是以字节为基本单位的， 如何扩展存储器的字长呢？其实方法很简单，只需要将**多个一位存储体的地址线并联在一起工作即可同时得到多位的数据**，这种方法称为**字长扩展**。

##### 静态 MOS 存储器的结构

![image-20250519160238186](D:\universityResource\_课程\计算机组成原理_大一下\pic\静态MOS存储器的结构.png)

##### 静态MOS存储器芯片实例

Intel 2114 是 Intel 公司推出的一款1K×4位的SRAM芯片，图4.11（a）所示为该芯片的封装引脚示意图，该芯片包括1024个字，字长4位；除电源和接地引脚外，该芯片还包括地址输 入引脚10个，数据双向输入输出引脚4个，另外还包括片选信号$\overline{CS}$ 和写使能信号$\overline{WE}$ 两个引脚。

![image-20250519160508603](D:\universityResource\_课程\计算机组成原理_大一下\pic\Intel_2114.png)

**X向驱动器需求比Y向更高， 所以通常设计成列地址少，行地址多。**

输入数据控制，写周期中：

*   地址有效后必须等待一段时间间隔，写信号WE才能有效，否则可能导致写出错
*   写信号WE无效后，还要经过一段时间间隔才能改变地址，否则也容易导致写出错
*   教材P105（读写周期时序，有兴趣可以看看，不做要求）

##### SRAM读写时序

存储器具有自己的读写周期特性，只有按照存储器的读写周期去访问存储器才能保证读写操作的正确性。

见书105页。

#### 4.2.2 动态MOS存储器DRAM

存储体以动态MOS存储元为基本单元组成的存储器称为动态MOS存储器（DRAM）。

SRAM需要6个MOS管才能存储1位数据，存储密度较低；另外即使存储单元不进行读写，功耗管和导通的工作管之间也有电流存在，其功耗较大。为了去掉MOS管中的功耗管，**引入了存储电容暂存电荷的方式来保存数据**。由此出现了4管DRAM存储单元，包含4个MOS管和2个存储电容；还有3MOS管和1个存储电容的存储单元，如Intel公司第一块DRAM芯片1103。**目前在内存中较为常见的结构是单管动态MOS存储单元。**

>   [!IMPORTANT]
>
>   DRAM和SRAM的比较：
>
>   -   SRAM：
>       -   **使用MOS管多，存储密度低，功耗大**
>       -   **存在功耗管，数据不会丢失，无需刷新操作**
>       -   **读写速度更快**
>       -   **价格更贵，常用于构造高速缓存Cache**
>   -   DRAM：
>       -   **只需要一个MOS管和一个存储电容**，**存储密度高**，功耗小
>       -   电容存储电荷容易泄露，需要刷新
>       -   **读出操作属于破坏操作，需要进行数据恢复**
>       -   **电容充放电时间长导致读写速度更慢**
>       -   **价格便宜，适合构造大容量的半导体存储器**，如**主存**

##### 单管动态MOS存储单元

单管动态MOS存储单元仅仅**使用一个MOS管和一个电容构成存储单元**，这也是目前内存中基本存储单元的结构，基本存储单元如图4.13中蓝色圆圈内部的电路所示。

![image-20250519164503930](D:\universityResource\_课程\计算机组成原理_大一下\pic\单管DRAM内部电路.png)

**单管动态MOS存储单元利用存储电容C是否带电荷来表示数据，有电荷表示数据“1”， 无电荷表示数据“0”。**

##### DRAM特点

1.   **存储电容的容量比寄生电容要小一个量级**，所以执行**读操作时二者进行电荷重分配产生**的**电流十分微弱**，需要用**非常灵敏的差分放大器**进行检测。
2.   读操作可能会引起电荷减少，从而破坏原有数据，为避免数据丢失，读出后会将数据重新写入，该过程称为**数据恢复**。
3.   数据恢复以及读出信号放大的逻辑由再生放大电路实现，**通常每组列线上都有一个共享的再生放大电路**，该电路为该列上所有存储单元所共享。
4.   电容上的电荷会逐渐泄漏，数据只能保存较短的时间。为避免数据丢失，必须定期采用**类似读操作**的方式对存储单元补充电荷，这个过程称为刷新，这也是动态RAM得名的原因。
5.   图中也包含两条对称的位线，每一列都包含一组共享的预充电路和读出放大检测电路。读出放大检测电路由4个MOS管构成，是一个跷跷板电路。**当位线上的电压有微弱差异时，跷跷板电路的平衡被打破，电压略高一侧会变成稳定的高电平逻辑“1”，另一侧则变成稳定的低电平逻辑“0”。**

##### DRAM的读写操作流程

与SRAM不同，**DRAM的地址线采用分时复用技术**。在访问存储单元时，**不能同时给出行地址和列地址**，而是需要先通过地址引脚发送行地址（并锁存到行地址缓冲器），再通过**同一组**地址引脚发送列地址（锁存到列地址缓冲器）。

**这种设计只需一套地址引脚，大幅减少了芯片封装引脚数量，但需要额外的行选通（RAS）和列选通（CAS）控制信号配合时序操作。**



-   DRAM的读操作流程：

1.   预充操作 Precharge：给出预充信号，由预充电路将位线$D$和 $\overline{D}$预充到$V_{CC} / 2$的电压后，此时位线上的寄生电容保持$V_{CC} / 2$ 的电压；**预充的目的是加速读取的过程，类似将跷跷板支撑到一定的高度， 方便跷跷板一上一下**。

2.   访问操作 Access：

     行选通，T1管导通
     存储电容C和位线D的寄生电容电荷重分配：

     ​	存储电容有电荷：存储数据“1”，电容向位线D放电，D上的电压将略高于$Vcc/2$ 

     ​	 存储电容无电荷：存储数据“0”，位线D向电容充电， D上的电压将略低于$Vcc/2$ 

     引起两个位线D 和$\overline{𝐷}$上的电压微弱差异。

3.   信号检测 Sense

4.   数据恢复 Restore

5.   数据输出 Output

写操作流程也需要经历与读操作前 4 步一样的流程，这样写入操作也可以实现和读操作一样的行刷新功能，数据恢复后只需给出列选通信号，将写入数据由 D 和 $\overline{D}$ 线送入即可。写入“1”时，位线上的高电平使得存储电容充电；写入“0”时，位线 D 上的低电平使得存储电容放电；完成充、放电后，撤除行选通信号，使得 T$_1$ 管截止，完成写入操作。

**感觉这一段学懂太难了，交给题目拟合吧**

**在书的107页，老师ppt的42页**

##### DRAM存储的刷新

-   **刷新**：定期补充电荷，避免电容的电荷泄露引起的信息丢失。

-   **刷新周期**: 存储器两次完整刷新之间的时间间隔
    -   信息存储到泄漏之间必须完成刷新，称为**最大刷新周期**
    -   不同材料和生产工艺，最大刷新周期不同，常见的有2ms、4ms、8ms
    -   **理论上减少存储矩阵的行数，增加列数，可以减少刷新周期**，因为是按行刷新
-   按行刷新
    -   **刷新地址由刷新地址计数器产生，而不是由CPU发出**，刷新地址计数器的位数与动态存储芯片内部的行结构有关，通常刷新操作由内存控制器负责。如果某动态存储芯片内部有256行，则刷新地址计数器至少为8位，在每个刷新周期内，该计数器的值从00000000到11111111循环一次。
-   读操作虽然具有刷新功能，但读操作与刷新操作又有所不同，**刷新操作只需要给出行地址**，而不需要给出列地址。
-   刷新时DRAM不能响应CPU的访问，所以CPU访问内存和内存控制器刷新操作存在内存**争用问题**，常见的解决方式有**集中刷新、分散刷新、异步刷新**3种。

###### Burst Refresh

-   **原理**：在固定的时间间隔内，集中安排一段时间对所有存储单元进行连续刷新。在此期间，存储器暂停所有读写操作。
-   **特点**：
    -   **优点**：刷新操作集中完成，刷新期间外存储器可以全速工作，读写效率高。
    -   **缺点**：刷新期间会阻塞所有读写请求（称为“死时间”），可能导致系统延迟。
-   **适用场景**：对连续读写性能要求高、能容忍短暂阻塞的场景。
-   假设DRAM有8192行，刷新周期为64ms，集中刷新时可能在2ms内连续刷新所有行，期间存储器不可用。

###### Distributed Refresh

-   **原理**：将刷新操作分散到整个刷新周期内，每次刷新一行或几行，而不是集中完成。通常在每个正常的读写周期后插入一个刷新周期。
-   **特点**：
    -   **优点**：避免了集中刷新的“死时间”，系统响应更平滑。
    -   **缺点**：由于频繁插入刷新操作，存储器的有效带宽会降低。
-   **适用场景**：对实时性要求高、不能接受长时间阻塞的系统。
-   在64ms的刷新周期内，每隔7.8μs（64ms/8192行）自动刷新一行，与读写操作交替进行。

###### Asynchronous Refresh

-   **原理**：刷新操作由外部控制器异步触发，与存储器的正常读写操作独立。**刷新请求可以优先级较低，在系统空闲时执行。**
-   **特点**：
    -   **优点**：灵活性高，可动态调整刷新时机，减少对性能的影响。
    -   **缺点**：需要复杂的控制器协调刷新和读写操作。
-   **适用场景**：低功耗设备或需要动态优化性能的场景（如移动设备）。
-   **CPU检测到总线空闲时，触发刷新操作；若系统繁忙，则延迟刷新。**

##### DRAM实例

动态MOS存储器芯片与静态MOS存储器芯片的结构**大致相同**。但由于动态MOS存储器芯片**集成度高**，而且要进行**刷新**操作，因此它的外围电路**相对要复杂**一些。

2116是一种典型的DRAM芯片。图4.15所示为动态MOS存储器芯片2116的逻辑符号和内部结构。

![image-20250521085224217](D:\universityResource\_课程\计算机组成原理_大一下\pic\DRAM实例2116芯片.png)

2116 表示 16K × 1 位存储芯片，其采用地址复用技术，分别由行地址选通信号 $ \overline{RAS} $ 和列地址选通信号$ \overline{CAS}$ 先后将 7 位地址 A0 ∼ A6 分别锁存到行地址锁存器与列地址锁存器中。存储矩阵为 128 × 128 结构；7 条行地址线也可作为刷新地址，刷新时用于地址计数，逐行刷新。

行、列地址译码后均产生 128 条选择线。选中某行时，该行的 128 个存储元都被选通到放大再生电路中，在那里每个存储单元会进行预充、访问、检测、恢复的过程。而列译码器中只选通 128 个放大器中的一个，将读出的信息送入输出缓冲器中。

从前面的分析可看出，DRAM 的结构大体与 SRAM 存储芯片相似，二者的不同点如下：
（1）**地址线一般采用复用技术，即 CPU 分时传送行、列地址，并分别由行选通信号 RAS 和列选通信号 CAS 选通。**
（2）**DRAM 无片选信号，通常可由 RAS 和 CAS 选通信号代替。**
（3）数据输入$ D_{IN} $和数据输出 $ D_{OUT}$**分开且可锁存**。

















---

---

---

# 补充知识

## MOS管